<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notícias - Rachão Santa Casa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f4f4f5;
            --card-bg-color: #ffffff;
            --border-color: #e5e7eb;
            --text-primary: #111827;
            --text-secondary: #4b5563;
            --accent-color: #eab308;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-color); color: var(--text-primary); }
        .card { 
            background-color: var(--card-bg-color); 
            border-radius: 1.5rem; 
            border: 1px solid var(--border-color); 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
        }
    </style>
</head>
<body class="antialiased">
    <div class="max-w-7xl mx-auto p-4 md:p-8">
        <header class="text-center mb-10">
            <img src="https://marcelogimenesfotografia.github.io/rachaosantacasa/logorachao.png" alt="Logo Rachão Santa Casa" class="w-full max-w-[280px] mx-auto">
            <nav class="mt-4">
                <ul class="flex justify-center gap-6 md:gap-8">
                    <li><a href="index.html" class="font-semibold text-gray-700 hover:text-yellow-500 transition">Classificação</a></li>
                    <li><a href="ranking_geral.html" class="font-semibold text-gray-700 hover:text-yellow-500 transition">Ranking Geral</a></li>
                    <li><a href="equipes.html" class="font-semibold text-gray-700 hover:text-yellow-500 transition">Equipes</a></li>
                    <li><a href="noticias.html" class="font-semibold text-yellow-500 transition">Notícias</a></li>
                    <li><a href="bolao.html" class="font-semibold text-gray-700 hover:text-yellow-500 transition">Bolão</a></li>
                    <li><a href="sobre.html" class="font-semibold text-gray-700 hover:text-yellow-500 transition">Sobre o Rachão</a></li>
                </ul>
            </nav>
        </header>

        <main>
            <div class="text-center mb-10">
                <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900">Últimas Notícias</h1>
                <p class="mt-2 text-lg text-gray-500">Fique por dentro de tudo o que acontece no Rachão Santa Casa.</p>
            </div>

            <div id="loading-overlay" class="text-center p-10">
                <p class="text-lg font-semibold text-gray-500">A carregar notícias...</p>
            </div>

            <div id="news-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- As notícias serão inseridas aqui -->
            </div>
        </main>
        
        <footer class="mt-12 pt-8 text-center text-gray-500 border-t border-gray-200">
            <img src="https://marcelogimenesfotografia.github.io/rachaosantacasa/logorachao.png" alt="Logo Rachão Santa Casa" class="w-20 h-auto mx-auto mb-2 opacity-80">
            <p class="text-sm font-semibold">Nós pedalamos forte, mas o que nos mantém juntos é a amizade.</p>
        </footer>
    </div>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCWsgx2mSOPwNwWBwl373DJ3oj7VuFwy9Y",
            authDomain: "rachaosc.firebaseapp.com",
            projectId: "rachaosc",
            storageBucket: "rachaosc.appspot.com",
            messagingSenderId: "28309536958",
            appId: "1:28309536958:web:eac51586cdabd82f691eef"
        };
        
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function loadNoticias() {
            const loadingOverlay = document.getElementById('loading-overlay');
            const newsGrid = document.getElementById('news-grid');

            try {
                const q = query(collection(db, "noticias"), orderBy("createdAt", "desc"));
                const querySnapshot = await getDocs(q);

                if (querySnapshot.empty) {
                    newsGrid.innerHTML = '<p class="text-center text-gray-500 col-span-full">Nenhuma notícia encontrada.</p>';
                    return;
                }

                querySnapshot.forEach(doc => {
                    const noticia = doc.data();
                    const date = noticia.createdAt?.toDate ? noticia.createdAt.toDate().toLocaleDateString('pt-BR') : '';
                    const snippet = noticia.content.substring(0, 100) + '...';

                    const card = document.createElement('a');
                    card.href = `noticia.html?id=${doc.id}`;
                    card.className = 'card block';
                    card.innerHTML = `
                        <img src="${noticia.imageUrl}" alt="${noticia.title}" class="w-full h-48 object-cover">
                        <div class="p-6">
                            <p class="text-sm text-gray-500 mb-2">${date}</p>
                            <h2 class="text-xl font-bold mb-2 text-gray-900">${noticia.title}</h2>
                            <p class="text-gray-600">${snippet}</p>
                        </div>
                    `;
                    newsGrid.appendChild(card);
                });

            } catch (error) {
                console.error("Erro ao carregar notícias:", error);
                newsGrid.innerHTML = '<p class="text-center text-red-500 col-span-full">Ocorreu um erro ao carregar as notícias.</p>';
            } finally {
                loadingOverlay.style.display = 'none';
            }
        }

        loadNoticias();
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notícia - Rachão Santa Casa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <!-- Adicionado Marked.js para renderizar Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root {
            --bg-color: #f4f4f5;
            --card-bg-color: #ffffff;
            --border-color: #e5e7eb;
            --text-primary: #111827;
            --text-secondary: #4b5563;
            --accent-color: #eab308;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-color); color: var(--text-primary); }
        .card { 
            background-color: var(--card-bg-color); 
            border-radius: 1.5rem; 
            padding: 3rem; 
            border: 1px solid var(--border-color); 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            margin-bottom: 2rem; 
        }
        /* Estilos para o conteúdo renderizado a partir de Markdown */
        .prose { max-width: none; color: var(--text-secondary); }
        .prose p { margin-bottom: 1.25em; line-height: 1.8; font-size: 1.125rem; }
        .prose a { color: var(--accent-color); text-decoration: underline; font-weight: 500; }
        .prose strong { color: var(--text-primary); }
        .prose h2, .prose h3 { color: var(--text-primary); font-weight: 700; margin-top: 2em; margin-bottom: 1em; }
        .prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1.25em; }
        .prose li { margin-bottom: 0.5em; }
        .prose img, .prose iframe { width: 100%; border-radius: 0.75rem; margin-top: 2em; margin-bottom: 2em; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="antialiased">
    <div class="max-w-5xl mx-auto p-4 md:p-8">
        <header class="text-center mb-10">
            <img src="https://marcelogimenesfotografia.github.io/rachaosantacasa/logorachao.png" alt="Logo Rachão Santa Casa" class="w-full max-w-[280px] mx-auto">
            <nav class="mt-4">
                <ul class="flex justify-center gap-6 md:gap-8">
                    <li><a href="index.html" class="font-semibold text-gray-700 hover:text-yellow-500 transition">Classificação</a></li>
                    <li><a href="ranking_geral.html" class="font-semibold text-gray-700 hover:text-yellow-500 transition">Ranking Geral</a></li>
                    <li><a href="equipes.html" class="font-semibold text-gray-700 hover:text-yellow-500 transition">Equipes</a></li>
                    <li><a href="noticias.html" class="font-semibold text-yellow-500 transition">Notícias</a></li>
                    <li><a href="bolao.html" class="font-semibold text-gray-700 hover:text-yellow-500 transition">Bolão</a></li>
                    <li><a href="sobre.html" class="font-semibold text-gray-700 hover:text-yellow-500 transition">Sobre o Rachão</a></li>
                </ul>
            </nav>
        </header>

        <main>
            <div id="loading-overlay" class="text-center p-10 card">
                <p class="text-lg font-semibold text-gray-500">A carregar notícia...</p>
            </div>

            <div id="noticia-container" class="card hidden">
                <!-- O conteúdo da notícia será inserido aqui -->
            </div>
        </main>
        
        <footer class="mt-12 pt-8 text-center text-gray-500 border-t border-gray-200">
            <img src="https://marcelogimenesfotografia.github.io/rachaosantacasa/logorachao.png" alt="Logo Rachão Santa Casa" class="w-20 h-auto mx-auto mb-2 opacity-80">
            <p class="text-sm font-semibold">Nós pedalamos forte, mas o que nos mantém juntos é a amizade.</p>
        </footer>
    </div>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCWsgx2mSOPwNwWBwl373DJ3oj7VuFwy9Y",
            authDomain: "rachaosc.firebaseapp.com",
            projectId: "rachaosc",
            storageBucket: "rachaosc.appspot.com",
            messagingSenderId: "28309536958",
            appId: "1:28309536958:web:eac51586cdabd82f691eef"
        };
        
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function loadNoticia() {
            const loadingOverlay = document.getElementById('loading-overlay');
            const noticiaContainer = document.getElementById('noticia-container');
            
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id');

            if (!id) {
                noticiaContainer.innerHTML = '<p class="text-center text-red-500">Notícia não encontrada.</p>';
                loadingOverlay.style.display = 'none';
                noticiaContainer.classList.remove('hidden');
                return;
            }

            try {
                const docRef = doc(db, "noticias", id);
                const docSnap = await getDoc(docRef);

                if (docSnap.exists()) {
                    const noticia = docSnap.data();
                    const date = noticia.createdAt?.toDate ? noticia.createdAt.toDate().toLocaleDateString('pt-BR') : '';
                    // Utiliza o Marked.js para converter o conteúdo de Markdown para HTML
                    const contentHtml = marked.parse(noticia.content);
                    
                    document.title = `${noticia.title} - Rachão Santa Casa`;
                    
                    const shareUrl = encodeURIComponent(window.location.href);
                    const shareTitle = encodeURIComponent(noticia.title);

                    const shareButtonsHtml = `
                        <div class="mt-10 pt-6 border-t border-gray-200 flex items-center justify-center gap-4">
                            <span class="font-semibold text-gray-600">Partilhar:</span>
                            <a href="https://api.whatsapp.com/send?text=${shareTitle}%20${shareUrl}" target="_blank" class="w-10 h-10 flex items-center justify-center bg-green-500 text-white rounded-full hover:bg-green-600 transition">
                                <i class="fab fa-whatsapp"></i>
                            </a>
                            <a href="https://www.facebook.com/sharer/sharer.php?u=${shareUrl}" target="_blank" class="w-10 h-10 flex items-center justify-center bg-blue-600 text-white rounded-full hover:bg-blue-700 transition">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                            <a href="https://twitter.com/intent/tweet?url=${shareUrl}&text=${shareTitle}" target="_blank" class="w-10 h-10 flex items-center justify-center bg-black text-white rounded-full hover:bg-gray-800 transition">
                                <i class="fab fa-twitter"></i>
                            </a>
                        </div>
                    `;

                    noticiaContainer.innerHTML = `
                        <h1 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-2">${noticia.title}</h1>
                        <p class="text-gray-500 mb-6">${date}</p>
                        <img src="${noticia.imageUrl}" alt="${noticia.title}" class="w-full rounded-xl shadow-lg mb-8 aspect-video object-cover">
                        <div class="prose">${contentHtml}</div>
                        ${shareButtonsHtml}
                    `;
                } else {
                    noticiaContainer.innerHTML = '<p class="text-center text-red-500">Notícia não encontrada.</p>';
                }

            } catch (error) {
                console.error("Erro ao carregar notícia:", error);
                noticiaContainer.innerHTML = '<p class="text-center text-red-500">Ocorreu um erro ao carregar a notícia.</p>';
            } finally {
                loadingOverlay.style.display = 'none';
                noticiaContainer.classList.remove('hidden');
            }
        }

        loadNoticia();
    </script>
</body>
</html>

